
## 功能说明

腾讯云 CDN 支持对单个域名进行版本管理，一个版本对应一份域名配置，您可以对域名部署不同的版本。支持生产环境和模拟环境两种部署环境方式：

- 生产环境：即现网环境，实际加速服务生效的环境。
- 模拟环境：即沙箱，仅做域名功能测试的独立环境。在模拟环境中部署版本后，CDN 会为域名分配一个 IPv4 的 IP，修改客户端 HOST，将域名指向该 IP 即可进行测试。

>!
>1. 暂仅支持中国境内，未配置自有证书，未开启图片优化功能的域名启用版本管理。
>2. 每个环境中每次仅支持部署一个版本。
>3. 模拟环境规模较小，仅支持控制台域名配置测试，不可承载实际业务或性能测试。
>4. 刷新功能将同时作用于生产环境和模拟环境。


## 使用场景

- 域名配置灰度测试。




## 开启版本管理

登录 [CDN 控制台](https://console.cloud.tencent.com/cdn)，在菜单栏里选择【域名管理】，进入域名列表。点击要启用版本管理的域名，进入域名配置页面，右上角可看到【启用版本管理】。
![](https://main.qcloudimg.com/raw/41ca2d34e89e5ae2a90fd1a107256d43.png)
确认启用后，当前域名的配置自动生成为第一个版本：Ver.1，同时部署至生产环境和模拟环境。

## 版本管理

启用版本管理后可进入【版本管理页面】 ，查看和管理版本。不同的版本用版本号 **Ver.n (n=1,2,3,...)** 区分。
![](https://main.qcloudimg.com/raw/0ee030edb398d950e4bbaa3c68146ff6.png)
![](https://main.qcloudimg.com/raw/682201f68d1c3b4c0537c6dadc6daea4.png)

### 发布版本

对于已启用版本管理的域名，建议采用以下发布版本的步骤：

1. 在模拟环境中上线要测试或发布的版本。
2. 测试已部署在模拟环境中的版本。
3. 若要调整配置再次测试，需新增版本并提交，生成新版本，重复步骤 1-2。
4. 测试通过后，将版本同步至生产环境，将配置下发现网，全网生效。
5. 若更换生产环境中的版本，请重复步骤 1-4。

>!
>- 仅允许将版本列表中最新的版本（即版本号最大的版本）发布至模拟环境，历史版本均仅支持查看。
>- 后端特殊配置或平台升级优化会直接下发至生产环境，现网生效。
>- 若域名当前存在后端特殊配置或有平台升级优化，从测试环境同步版本至生产环境时可能会有冲突，此时请新建版本进行发布。

### 新增版本
单击【新增版本】：新增版本时的版本配置默认为当前生产环境中的版本，可在此基础上调整并提交，生产新版本。

### 编辑版本

版本列表中最新的版本未发布至模拟环境时，可以编辑：单击版本操作列的【更多】 > 【编辑】。

历史版本（最新版本之前的所有版本）不论是否有发布至模拟环境，均不可编辑，仅支持查看。

>!新增版本前请确认是否还有未发布的版本，因为新增版本后该版本会自动变为历史版本，不可编辑也不可发布至模拟环境。

### 查看版本

单击对应版本操作列的【查看】，可查看该版本中的配置内容。


### 下线版本
单击生产环境中的【下线】，即对域名进行下线，关闭加速服务。


## 停用版本管理

对于正常运行中，已启用版本管理的域名，您也可以停用版本管理。停用后，将回复到基础的现网配置模式，以当前生产环境已上线的版本为现网配置。其他存量版本均会消失，不可恢复。

若有需要，您可再次启用版本管理。


## 注意事项

已开启版本管理的域名：
不支持 [复制配置](https://cloud.tencent.com/document/product/228/49576)，[批量变更配置](https://cloud.tencent.com/document/product/228/53940) 等批量配置功能。
不支持在控制台左侧的证书管理页面单独配置证书。
关闭/启动加速服务时，会同时下线/上线生产环境和模拟环境中的版本。
